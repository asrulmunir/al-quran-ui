<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Al-Quran API Showcase</title>
    <!-- NO EXTERNAL CSS - USING INLINE STYLES ONLY -->
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: Arial, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh; 
            color: #333; 
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        header { text-align: center; color: white; margin-bottom: 30px; }
        header h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .tab-nav { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 5px; 
            margin-bottom: 30px; 
            background: rgba(255,255,255,0.1); 
            padding: 10px; 
            border-radius: 15px; 
        }
        .tab-btn { 
            flex: 1; 
            min-width: 120px; 
            padding: 12px 16px; 
            border: none; 
            background: rgba(255,255,255,0.2); 
            color: white; 
            border-radius: 8px; 
            cursor: pointer; 
            font-weight: 600; 
        }
        .tab-btn.active { background: rgba(255,255,255,0.4); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .section { 
            background: rgba(255,255,255,0.95); 
            padding: 30px; 
            margin-bottom: 20px; 
            border-radius: 15px; 
        }
        .btn { 
            padding: 12px 24px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-weight: 600; 
            margin: 5px; 
        }
        .btn.primary { background: #667eea; color: white; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; }
        input, select { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; }
        .mobile-menu-toggle { display: none; }
        @media (max-width: 768px) {
            .tab-nav { flex-direction: column; }
            .mobile-menu-toggle { 
                display: flex; 
                flex-direction: column; 
                width: 30px; 
                height: 30px; 
                background: transparent; 
                border: none; 
                cursor: pointer; 
            }
            .hamburger-line { width: 25px; height: 3px; background: white; margin: 2px 0; }
            .tab-nav-content { display: none; flex-direction: column; width: 100%; }
            .tab-nav-content.show { display: flex; }
            .tab-btn { width: 100%; text-align: left; min-width: auto; }
        }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🕌 Al-Quran API Showcase</h1>
            <p>Complete demonstration of all API functionalities</p>
        </header>

        <nav class="tab-nav">
            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            
            <div class="tab-nav-content">
                <button class="tab-btn active" data-tab="info">API Info</button>
                <button class="tab-btn" data-tab="chapters">Chapters</button>
                <button class="tab-btn" data-tab="verses">Verses</button>
                <button class="tab-btn" data-tab="compare">Compare</button>
                <button class="tab-btn" data-tab="search">Search Arabic</button>
                <button class="tab-btn" data-tab="search-translation">Search Translation</button>
                <button class="tab-btn" data-tab="translations">Translations</button>
                <button class="tab-btn" data-tab="stats">Statistics</button>
                <button class="tab-btn" data-tab="screenshot">Screenshot</button>
                <button class="tab-btn" data-tab="flashcard">Flashcard</button>
            </div>
        </nav>

        <main>
            <!-- API Info Tab -->
            <div class="tab-content active" id="info">
                <div class="section">
                    <h2>📊 API Information</h2>
                    <p>This version uses inline CSS only to ensure loading.</p>
                    <button onclick="loadApiInfo()" class="btn primary">Load API Info</button>
                    <div id="api-info-result"></div>
                </div>
            </div>

            <!-- Flashcard Tab -->
            <div class="tab-content" id="flashcard">
                <div class="section">
                    <h2>🎯 Arabic Vocabulary Flashcards</h2>
                    <p>Learn Quranic Arabic vocabulary with interactive flashcards. Select a chapter and translation language to start memorizing words.</p>
                    
                    <div class="form-group">
                        <label for="flashcard-chapter-select">Chapter:</label>
                        <select id="flashcard-chapter-select">
                            <option value="">Select a chapter</option>
                            <option value="1">1. Al-Fatihah (The Opening)</option>
                            <option value="2">2. Al-Baqarah (The Cow)</option>
                            <option value="3">3. Ali 'Imran (Family of Imran)</option>
                            <option value="18">18. Al-Kahf (The Cave)</option>
                            <option value="36">36. Ya-Sin</option>
                            <option value="67">67. Al-Mulk (The Sovereignty)</option>
                            <option value="112">112. Al-Ikhlas (The Sincerity)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="flashcard-language-select">Translation Language:</label>
                        <select id="flashcard-language-select">
                            <option value="en">English (Hilali-Khan)</option>
                            <option value="ms">Malay (Basmeih)</option>
                            <option value="zh">Chinese (Ma Jian)</option>
                            <option value="ta">Tamil (Jan Trust)</option>
                        </select>
                    </div>
                    
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin: 20px 0;">
                        <button onclick="startFlashcards()" class="btn primary">Start Flashcards</button>
                        <button onclick="nextFlashcard()" class="btn" id="next-flashcard-btn" style="display: none; background: #28a745; color: white;">Next Word</button>
                        <button onclick="shuffleFlashcards()" class="btn" id="shuffle-btn" style="display: none; background: #ffc107; color: black;">Shuffle</button>
                        <button onclick="resetFlashcards()" class="btn" id="reset-btn" style="display: none; background: #6c757d; color: white;">Reset</button>
                    </div>
                </div>

                <div class="section" id="flashcard-section" style="display: none;">
                    <div style="max-width: 600px; margin: 0 auto; text-align: center;">
                        <!-- Progress -->
                        <div style="margin-bottom: 20px;">
                            <span id="flashcard-counter" style="font-weight: 600; color: #2c3e50;">0 / 0</span>
                            <div style="width: 100%; height: 8px; background: rgba(255,255,255,0.3); border-radius: 4px; margin-top: 10px; overflow: hidden;">
                                <div id="flashcard-progress" style="height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); border-radius: 4px; transition: width 0.3s ease; width: 0%;"></div>
                            </div>
                        </div>
                        
                        <!-- Flashcard -->
                        <div id="flashcard" onclick="flipFlashcard()" style="width: 100%; height: 300px; perspective: 1000px; margin: 20px 0; cursor: pointer;">
                            <div id="flashcard-inner" style="position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d;">
                                <!-- Front -->
                                <div id="flashcard-front" style="position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 15px; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <div id="flashcard-arabic" style="font-family: 'Amiri', 'Traditional Arabic', serif; font-size: 3rem; font-weight: 700; margin-bottom: 20px; direction: rtl; line-height: 1.2;">Click Start</div>
                                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 15px;">
                                        <span id="flashcard-location" style="background: rgba(255,255,255,0.2); padding: 5px 12px; border-radius: 20px; font-size: 0.9rem; font-weight: 500;"></span>
                                        <span id="flashcard-position" style="background: rgba(255,255,255,0.2); padding: 5px 12px; border-radius: 20px; font-size: 0.9rem; font-weight: 500;"></span>
                                    </div>
                                </div>
                                <!-- Back -->
                                <div id="flashcard-back" style="position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 15px; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); color: white; transform: rotateY(180deg);">
                                    <div id="flashcard-translation" style="font-size: 1.5rem; font-weight: 600; margin-bottom: 15px; line-height: 1.3;">Translation</div>
                                    <div id="flashcard-context" style="font-size: 1.1rem; opacity: 0.9; line-height: 1.4; max-width: 400px; text-align: center;">Context will appear here</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Navigation -->
                        <div style="display: flex; justify-content: center; gap: 15px; margin: 30px 0; flex-wrap: wrap;">
                            <button onclick="previousFlashcard()" id="prev-btn" style="padding: 12px 20px; border: none; border-radius: 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; cursor: pointer;">← Previous</button>
                            <button onclick="flipFlashcard()" style="padding: 12px 20px; border: none; border-radius: 25px; background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); color: white; font-weight: 600; cursor: pointer;">🔄 Flip</button>
                            <button onclick="nextFlashcard()" id="next-btn" style="padding: 12px 20px; border: none; border-radius: 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; cursor: pointer;">Next →</button>
                        </div>
                        
                        <!-- Statistics -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 12px;">
                            <div style="text-align: center;">
                                <div style="font-size: 0.9rem; opacity: 0.8; margin-bottom: 5px;">Chapter</div>
                                <div id="current-chapter" style="font-size: 1.1rem; font-weight: 600; color: #2c3e50;">-</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 0.9rem; opacity: 0.8; margin-bottom: 5px;">Total Words</div>
                                <div id="total-words" style="font-size: 1.1rem; font-weight: 600; color: #2c3e50;">-</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 0.9rem; opacity: 0.8; margin-bottom: 5px;">Language</div>
                                <div id="current-language" style="font-size: 1.1rem; font-weight: 600; color: #2c3e50;">-</div>
                            </div>
                        </div>
                        
                        <!-- Instructions -->
                        <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px; font-size: 0.9rem; opacity: 0.8;">
                            <strong>💡 Instructions:</strong> Click the card or use Space/Enter to flip • Use ← → arrow keys to navigate • Ctrl+R to shuffle
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other tabs placeholder -->
            <div class="tab-content" id="chapters">
                <div class="section">
                    <h2>📚 Chapters</h2>
                    <p>Chapter functionality will be restored once flashcard issue is resolved.</p>
                </div>
            </div>

            <div class="tab-content" id="verses">
                <div class="section">
                    <h2>📝 Verses</h2>
                    <p>Verse functionality will be restored once flashcard issue is resolved.</p>
                </div>
            </div>

            <div class="tab-content" id="compare">
                <div class="section">
                    <h2>🔄 Compare</h2>
                    <p>Compare functionality will be restored once flashcard issue is resolved.</p>
                </div>
            </div>

            <div class="tab-content" id="search">
                <div class="section">
                    <h2>🔍 Search Arabic</h2>
                    <p>Search functionality will be restored once flashcard issue is resolved.</p>
                </div>
            </div>

            <div class="tab-content" id="search-translation">
                <div class="section">
                    <h2>🌐 Search Translation</h2>
                    <p>Translation search will be restored once flashcard issue is resolved.</p>
                </div>
            </div>

            <div class="tab-content" id="translations">
                <div class="section">
                    <h2>📖 Translations</h2>
                    <p>Translations functionality will be restored once flashcard issue is resolved.</p>
                </div>
            </div>

            <div class="tab-content" id="stats">
                <div class="section">
                    <h2>📈 Statistics</h2>
                    <p>Statistics functionality will be restored once flashcard issue is resolved.</p>
                </div>
            </div>

            <div class="tab-content" id="screenshot">
                <div class="section">
                    <h2>📸 Screenshot</h2>
                    <p>Screenshot functionality will be restored once flashcard issue is resolved.</p>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Basic tab functionality
        document.addEventListener('DOMContentLoaded', function() {
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');

            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const tabId = btn.getAttribute('data-tab');
                    
                    // Remove active class from all tabs and contents
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab and corresponding content
                    btn.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        });

        // Mobile menu toggle
        function toggleMobileMenu() {
            const menuToggle = document.querySelector('.mobile-menu-toggle');
            const navContent = document.querySelector('.tab-nav-content');
            
            if (menuToggle && navContent) {
                navContent.classList.toggle('show');
            }
        }

        // Flashcard functionality
        let flashcardData = [];
        let currentFlashcardIndex = 0;
        let isFlashcardFlipped = false;

        // API request function
        async function apiRequest(endpoint) {
            const response = await fetch(`https://quran-api.asrulmunir.workers.dev${endpoint}`);
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            return await response.json();
        }

        // Get translation key for language
        function getTranslationKey(language) {
            const keys = {
                'en': 'english',
                'ms': 'malay', 
                'zh': 'chinese',
                'ta': 'tamil'
            };
            return keys[language] || 'english';
        }

        // Decode HTML entities
        function decodeHtmlEntities(text) {
            const textarea = document.createElement('textarea');
            textarea.innerHTML = text;
            return textarea.value;
        }

        // Shuffle array
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Start flashcards
        async function startFlashcards() {
            const chapterSelect = document.getElementById('flashcard-chapter-select');
            const languageSelect = document.getElementById('flashcard-language-select');
            
            const chapter = chapterSelect.value;
            const language = languageSelect.value;
            
            if (!chapter) {
                alert('Please select a chapter');
                return;
            }
            
            try {
                // Show loading
                document.getElementById('flashcard-arabic').textContent = 'Loading...';
                
                // Get first verse data (for performance)
                const verseData = await apiRequest(`/api/verses/${chapter}/1`);
                
                if (!verseData || !verseData.tokens) {
                    throw new Error('No token data found');
                }
                
                // Get translation for the verse
                const compareData = await apiRequest(`/api/compare/${chapter}/1`);
                const translationKey = getTranslationKey(language);
                const translation = compareData.translations[translationKey];
                const translationText = translation ? decodeHtmlEntities(translation.text) : 'Translation not available';
                
                // Create flashcards from tokens
                const words = verseData.tokens.map(token => ({
                    arabic: token.text,
                    location: `${chapter}:1`,
                    position: `Word ${token.number}`,
                    verseTranslation: translationText,
                    verseArabic: verseData.text,
                    tokenNumber: token.number,
                    verseNumber: 1
                }));
                
                // Shuffle the words
                flashcardData = shuffleArray(words);
                currentFlashcardIndex = 0;
                
                // Update UI
                updateFlashcardDisplay();
                showFlashcardSection();
                updateFlashcardStats(chapter, language);
                
            } catch (error) {
                console.error('Failed to load flashcard data:', error);
                alert(`Failed to load flashcard data: ${error.message}`);
                document.getElementById('flashcard-arabic').textContent = 'Click Start';
            }
        }

        // Show flashcard section
        function showFlashcardSection() {
            document.getElementById('flashcard-section').style.display = 'block';
            document.getElementById('next-flashcard-btn').style.display = 'inline-block';
            document.getElementById('shuffle-btn').style.display = 'inline-block';
            document.getElementById('reset-btn').style.display = 'inline-block';
        }

        // Update flashcard display
        function updateFlashcardDisplay() {
            if (flashcardData.length === 0) return;
            
            const currentWord = flashcardData[currentFlashcardIndex];
            
            // Update Arabic word
            document.getElementById('flashcard-arabic').textContent = currentWord.arabic;
            document.getElementById('flashcard-location').textContent = currentWord.location;
            document.getElementById('flashcard-position').textContent = currentWord.position;
            
            // Update translation
            document.getElementById('flashcard-translation').textContent = 'Verse Translation:';
            document.getElementById('flashcard-context').textContent = currentWord.verseTranslation;
            
            // Update progress
            updateFlashcardProgress();
            
            // Reset flip state
            resetFlashcardFlip();
        }

        // Update progress
        function updateFlashcardProgress() {
            const counter = document.getElementById('flashcard-counter');
            const progressBar = document.getElementById('flashcard-progress');
            
            counter.textContent = `${currentFlashcardIndex + 1} / ${flashcardData.length}`;
            
            const progress = ((currentFlashcardIndex + 1) / flashcardData.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // Update stats
        function updateFlashcardStats(chapter, language) {
            const chapterSelect = document.getElementById('flashcard-chapter-select');
            const selectedOption = chapterSelect.options[chapterSelect.selectedIndex];
            const chapterName = selectedOption ? selectedOption.textContent : `Chapter ${chapter}`;
            
            const languageNames = {
                'en': 'English',
                'ms': 'Malay',
                'zh': 'Chinese',
                'ta': 'Tamil'
            };
            
            document.getElementById('current-chapter').textContent = chapterName;
            document.getElementById('total-words').textContent = flashcardData.length;
            document.getElementById('current-language').textContent = languageNames[language];
        }

        // Flip flashcard
        function flipFlashcard() {
            const flashcardInner = document.getElementById('flashcard-inner');
            if (isFlashcardFlipped) {
                flashcardInner.style.transform = 'rotateY(0deg)';
            } else {
                flashcardInner.style.transform = 'rotateY(180deg)';
            }
            isFlashcardFlipped = !isFlashcardFlipped;
        }

        // Reset flip
        function resetFlashcardFlip() {
            const flashcardInner = document.getElementById('flashcard-inner');
            flashcardInner.style.transform = 'rotateY(0deg)';
            isFlashcardFlipped = false;
        }

        // Navigation functions
        function nextFlashcard() {
            if (flashcardData.length === 0) return;
            currentFlashcardIndex = (currentFlashcardIndex + 1) % flashcardData.length;
            updateFlashcardDisplay();
        }

        function previousFlashcard() {
            if (flashcardData.length === 0) return;
            currentFlashcardIndex = currentFlashcardIndex === 0 
                ? flashcardData.length - 1 
                : currentFlashcardIndex - 1;
            updateFlashcardDisplay();
        }

        function shuffleFlashcards() {
            if (flashcardData.length === 0) return;
            flashcardData = shuffleArray(flashcardData);
            currentFlashcardIndex = 0;
            updateFlashcardDisplay();
        }

        function resetFlashcards() {
            currentFlashcardIndex = 0;
            if (flashcardData.length > 0) {
                updateFlashcardDisplay();
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            const activeTab = document.querySelector('.tab-content.active');
            if (activeTab && activeTab.id === 'flashcard' && flashcardData.length > 0) {
                switch(e.key) {
                    case 'ArrowLeft':
                        e.preventDefault();
                        previousFlashcard();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        nextFlashcard();
                        break;
                    case ' ':
                    case 'Enter':
                        e.preventDefault();
                        flipFlashcard();
                        break;
                    case 'r':
                    case 'R':
                        if (e.ctrlKey || e.metaKey) {
                            e.preventDefault();
                            shuffleFlashcards();
                        }
                        break;
                }
            }
        });

        // Placeholder API function
        function loadApiInfo() {
            alert('API Info function works! All JavaScript is loading correctly.');
        }
    </script>
</body>
</html>
